<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Project | 화재 감지 자율주행 순찰 로봇</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
<header>
  <div class="nav">
    <div class="nav-left">CR</div>
    <nav class="nav-right">
      <a href="index.html">Home</a>
      <a href="about.html">About</a>
      <a href="project.html" class="active">Project</a>
      <a href="board.html">board</a>
    </nav>
  </div>
</header>

<main class="project-detail-page">
  <div class="project-detail-inner">
    <div class="project-detail-card">

      <!-- 상단 제목 + 메타 -->
      <header class="project-detail-header">
        <h1 class="project-detail-title">화재 감지 자율주행 순찰 로봇</h1>
        <p class="project-detail-meta">
          2025.09.22 ~ 2025.11.27 · 4인 팀 프로젝트 · ROS2 기반 자율주행 / 화재 감지 순찰 시스템
        </p>
      </header>

      <!-- 대표 이미지 -->
      <div class="project-detail-image" style="background-image: url('images/patrol.png');"></div>

      <!-- 개요 / 역할 / 기술스택 -->
      <div class="project-detail-layout">
        <!-- 왼쪽: 개요 / 목적 / 요약 -->
        <div>
          <section class="project-detail-section">
            <h3>PROJECT OVERVIEW</h3>
            <p class="label-sub">프로젝트 설명</p>
            <p class="project-detail-text">
              ROS2 기반 자율주행 로봇이 실내 공간을 순찰하며 <strong>화재 위험을 조기에 감지</strong>하는 시스템이다.
              SLAM으로 실내 지도를 생성하고 Navigation2를 이용해 자율주행을 구현했으며,
              MQ-2 및 ENS160 센서를 통해 연기·가스 농도를 감지하고,
              웹 대시보드와 연동해 실시간 상태 확인과 제어가 가능하도록 구성했다.<br><br>
              단순히 로봇을 움직이는 수준이 아니라, <strong>정해진 공간을 자율적으로 순찰하고 상황에 따라 동작을 제어하는 운영 가능한 시스템</strong>을 목표로 했다.
            </p>
          </section>

          <section class="project-detail-section">
            <h3>PROJECT GOAL</h3>
            <p class="label-sub">프로젝트 목적</p>
            <ul class="project-detail-list">
              <li>ROS2 기반 자율주행 기술을 실제 로봇 환경에 적용</li>
              <li>SLAM + Navigation2를 활용한 실내 순찰 경로 구축</li>
              <li>웨이포인트 기반 순찰 로직 및 제어 구조 직접 설계</li>
              <li>화재 감지 이벤트 발생 시 정지 / 복귀 / 상태 제어를 할 수 있는 구조 구현</li>
              <li>로봇 상태를 웹에서 직관적으로 확인하고 제어할 수 있는 대시보드 연동</li>
            </ul>
          </section>
        </div>

        <!-- 오른쪽: 역할 / 기술스택 -->
        <div>
          <section class="project-detail-section">
            <h3>MY ROLE</h3>
            <p class="label-sub">주요 업무 및 상세 역할</p>
            <ul class="project-detail-list">
              <li>Ubuntu / ROS2 Humble 기반 개발 환경 및 네트워크 구성(VMware ↔ SBC)</li>
              <li>SLAM Toolbox를 활용한 실내 지도 생성 및 맵 저장·재사용 설정</li>
              <li>Navigation2 Bringup 구성 및 Costmap / AMCL 파라미터 튜닝</li>
              <li>웨이포인트 YAML 기반 순찰 로직 설계 및 <code>PatrolManager</code> 노드 구현</li>
              <li>순찰 시작 / 중단 / 재개 / 복귀 등 상태 관리 및 제어 흐름 설계</li>
              <li>화재 감지 이벤트 및 배터리 상태를 순찰 제어와 연동하는 의사결정 로직 구현</li>
              <li>ROS2 ↔ FastAPI ↔ WebSocket 간 명령·상태 전달 구조 설계</li>
            </ul>
          </section>

          <section class="project-detail-section">
            <h3>TECH STACK</h3>
            <p class="label-sub">사용 기술</p>
            <div class="project-detail-tags">
              <span class="tag-pill">ROS2 Humble</span>
              <span class="tag-pill">SLAM Toolbox</span>
              <span class="tag-pill">Navigation2</span>
              <span class="tag-pill">Python</span>
              <span class="tag-pill">Raspberry Pi</span>
              <span class="tag-pill">MQ-2 / ENS160</span>
              <span class="tag-pill">FastAPI</span>
              <span class="tag-pill">WebSocket</span>
              <span class="tag-pill">VMware</span>
            </div>
          </section>
        </div>
      </div>

      <!-- 타임라인 & 팀 구성 -->
      <section class="project-detail-section">
        <h3>TIMELINE & TEAM</h3>
        <p class="label-sub">작업 기간 및 인원 구성</p>
        <ul class="project-detail-list">
          <li><strong>작업 기간</strong> : 2025.09.22 ~ 2025.11.27 (약 9주)</li>
          <li><strong>인원 구성</strong> : 총 4인
            <ul class="project-detail-list" style="margin-top: 0.2rem;">
              <li>본인 – 자율주행 / SLAM / Navigation2 / Patrol System / 웹 연동</li>
              <li>팀원 A – 센서 연동 및 화재 감지 로직</li>
              <li>팀원 B – 웹 대시보드(FastAPI, UI)</li>
              <li>팀원 C – 전체 시스템 통합 및 테스트 지원</li>
            </ul>
          </li>
        </ul>
      </section>

      <!-- 개발 과정 (단계별) -->
      <section class="project-detail-section">
        <h3>DEVELOPMENT PROCESS</h3>
        <p class="label-sub">단계별 진행 내용 · 역할 · 문제 해결</p>

        <!-- 1단계 -->
        <h4 style="margin-top:0.6rem;">1단계. 개발 환경 구축</h4>
        <ul class="project-detail-list">
          <li>
            <strong>진행 내용</strong> :
            Ubuntu 22.04 기반 개발 환경을 구성하고, Raspberry Pi(SBC)와 VMware Ubuntu를 병행 사용하며
            ROS2 Humble 설치 및 기본 패키지 구성을 진행했다. SBC(로봇) ↔ 개발 PC 간 ROS2 토픽 통신이 가능한 네트워크 환경을 만드는 것이 목표였다.
          </li>
          <li>
            <strong>담당 역할</strong> :
            ROS2 설치 및 초기 설정, VMware 네트워크 브리지 구성, ROS_DOMAIN_ID 및 DDS 설정,
            <code>ros2 topic list / echo</code>를 통한 통신 테스트 및 디버깅을 담당했다.
          </li>
          <li>
            <strong>마주친 문제</strong> :
            SSH와 ping은 정상인데, 간헐적으로 <code>ros2 topic list</code>가 아무 것도 보이지 않는 문제가 반복되었다.
            재부팅 이후 특히 자주 발생해서 원인 파악이 필요했다.
          </li>
          <li>
            <strong>문제 분석</strong> :
            단순 네트워크 문제라기보다는 ROS2의 DDS 데몬이 정상적으로 동작하지 않는 상황으로 추정했다.
            VMware 네트워크 브리지 상태가 바뀌거나 재부팅 이후 DDS 캐시가 꼬이면서 토픽 디스커버리가 실패하는 패턴이 관찰되었다.
          </li>
          <li>
            <strong>해결 방안</strong> :
            <code>ros2 daemon stop</code> / <code>ros2 daemon start</code>를 통해 DDS 데몬을 재시작하면
            대부분의 케이스에서 통신이 복구되는 것을 확인했고, VMware 네트워크 모드를 Bridge로 고정했다.
            이후 통신 장애가 발생하면 “네트워크 → DDS 데몬 → ROS 노드” 순서로 원인을 분리해 확인하는 체크리스트를 만들어 운영했다.
          </li>
        </ul>

        <!-- 2단계 -->
        <h4 style="margin-top:1.0rem;">2단계. Mapping &amp; Navigation2</h4>

        <div class="project-detail-image" style="background-image: url('images/mapping.gif');">
        </div>
        <ul class="project-detail-list">
          <li>
            <strong>진행 내용</strong> :
            SLAM Toolbox를 사용해 실내 지도를 생성하고, 생성한 맵을 저장한 뒤 Navigation2에서 재사용하도록 구성했다.
            AMCL을 이용해 로봇 위치를 추정하고, 목적지를 지정하면 로봇이 스스로 경로를 계획해 이동하도록 설정했다.
          </li>
          <li>
            <strong>담당 역할</strong> :
            SLAM 실행 및 파라미터 설정, 맵 저장/로드 설정, Navigation2 Bringup 구성,
            Costmap·AMCL 파라미터 튜닝, RViz에서의 주행 테스트와 로그 분석을 담당했다.
          </li>
          <li>
            <strong>마주친 문제</strong> :
            반복 주행 과정에서 특정 구간에서 로봇 위치가 갑자기 튀거나(TF jump),
            경로를 이탈하는 현상이 발생했다. 특히 배터리 잔량이 낮을수록 증상이 심해졌다.
          </li>
          <li>
            <strong>문제 분석</strong> :
            배터리 전압이 떨어질수록 모터 출력이 불안정해지고,
            실제 이동거리와 인코더/추정 위치가 어긋나는 문제로 이어진다고 판단했다.
            동시에 Costmap의 inflation 범위와 obstacle layer 설정이 실제 환경에 비해 과도해
            경로가 불필요하게 크게 돌아가거나 재계획이 잦아지는 현상도 확인했다.
          </li>
          <li>
            <strong>해결 방안</strong> :
            배터리 상태를 별도로 모니터링하고, 임계치 이하로 떨어지면 순찰을 중단하고 원점으로 복귀하도록 로직을 추가했다.
            또한 inflation radius, obstacle layer, AMCL 파라미터를 여러 차례에 걸쳐 실험하며
            실제 공간에 맞게 조정했다. “한 번에 완벽한 파라미터”를 찾기보다는,
            반복 주행 테스트를 통해 점진적으로 튜닝하는 접근으로 안정성을 확보했다.
          </li>
        </ul>

        <!-- 3단계 -->
        <h4 style="margin-top:1.0rem;">3단계. Patrol System 구축</h4>
        <ul class="project-detail-list">
          <li>
            <strong>진행 내용</strong> :
            YAML 파일로 관리하는 웨이포인트 기반 순찰 시스템을 설계하고,
            FollowWaypoints 액션을 이용해 정해진 순서대로 지점을 순찰하도록 구현했다.
            순찰 시작 / 중단 / 재개 / 복귀 명령과 화재 감지 이벤트를 연결해
            실제 운영 상황을 가정한 제어 구조를 만들었다.
          </li>
          <li>
            <strong>담당 역할</strong> :
            <code>PatrolManager</code> 노드를 설계·구현하고, Waypoints YAML 구조 정의,
            순찰 상태 관리(State Machine) 설계, 화재 이벤트 및 배터리 조건을
            순찰 로직과 연동하는 의사결정 로직을 담당했다.
          </li>
          <li>
            <strong>마주친 문제</strong> :
            순찰 중 <code>pause → resume</code> 명령을 여러 번 반복하면,
            현재 순찰 상태가 꼬이거나 1회 순찰 후 자동 복귀가 되지 않는 문제가 발생했다.
            외부에서 들어오는 명령과 FollowWaypoints 액션의 상태가 서로 맞지 않는 경우가 자주 생겼다.
          </li>
          <li>
            <strong>문제 분석</strong> :
            순찰을 “한 번의 동작”으로만 보고 구현해,
            내부 상태(IDLE / RUNNING / PAUSED / RETURNING)가 명확하게 정의되지 않은 것이 핵심 원인이었다.
            액션 취소와 재요청 흐름도 정리되어 있지 않아, 외부 명령이 들어올 때마다 제어 흐름이 복잡해졌다.
          </li>
          <li>
            <strong>해결 방안</strong> :
            순찰을 <strong>상태 기반(State Machine)</strong>으로 다시 설계했다.
            <code>IDLE / PATROLLING / PAUSED / RETURNING</code> 상태를 명시적으로 두고,
            모든 외부 명령을 “상태 전이”로 해석하도록 구조를 변경했다.
            FollowWaypoints 액션은 해당 상태에서만 관리하고, 화재 이벤트가 발생하면
            즉시 액션을 cancel한 뒤 PAUSED 상태로 전환하도록 로직을 단순화했다.
            이를 통해 예외 상황에서도 예측 가능한 동작을 유지할 수 있게 되었다.
          </li>
        </ul>
      </section>

      <!-- 성과 & 배운 점 -->
      <section class="project-detail-section">
        <h3>OUTCOME &amp; LEARNINGS</h3>
        <p class="label-sub">프로젝트 성과 및 얻은 인사이트</p>
        <p class="project-detail-text">
          반복 테스트를 통해 순찰 성공률을 안정적으로 끌어올렸고,
          화재 이벤트 발생 시 정지·복귀 동작이 의도대로 동작하도록 구조를 정리했다.
          특히, 자율주행에서는 알고리즘 자체보다 <strong>제어 흐름과 상태 관리 설계</strong>가
          얼마나 중요한지 경험적으로 이해하게 된 프로젝트였다.<br><br>
          또한 분산 환경(ROS2, VMware, SBC)에서는 코드만 보는 것이 아니라
          네트워크, DDS 데몬, 배터리 상태 등 런타임 환경 전체를 함께 보는 시야가 필요하다는 점을 배웠다.
          단순히 “돌아가는 코드”를 넘어서, 운영 가능한 구조와 디버깅 가능한 설계를 신경 쓰게 된 계기였다.
        </p>

        <div class="project-detail-links">
          <a href="https://github.com/smartcore102/Yeonhee_smartcore.git"
             target="_blank"
             class="project-detail-link github">
            GitHub Repository
          </a>
          <a href="project.html" class="project-detail-link">
            ← 프로젝트 목록으로
          </a>
        </div>
      </section>

    </div>
  </div>
</main>

<footer>
  <p>© 2025 Chaeryeon</p>
</footer>
</body>
</html>
